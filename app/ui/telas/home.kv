<HomeScreen>:
    name: "home"
    MDFloatLayout:
        # KivyMD 2.0.0: Sintaxe de cor 'rgba'
        md_bg_color: rgba(146, 199, 163, 255)

        # --- Logo (Flor) ---
        Image:
            source: "app/assets/img.png"
            size_hint: None, None
            size: "80dp", "80dp"
            allow_stretch: True
            pos_hint: {'center_x': .5, 'top': .96}

        # --- Ícone de Notificação (Sino) ---
        MDIconButton:
            icon: "bell-outline"
            pos_hint: {'right': .95, 'top': .96}
            theme_icon_color: "Custom" # KivyMD 2.0.0: Obrigatório
            icon_color: rgba(51, 51, 51, 255)
            on_release: app.root.current = 'notifications'

        # --- Container para os Botões Centrais ---
        MDBoxLayout:
            orientation: 'vertical'
            size_hint: .8, None
            adaptive_height: True
            pos_hint: {'center_x': .5, 'top': .80} # Posição ajustada
            spacing: "15dp"

            # KivyMD 2.0.0: MDButton usa 'text', não 'MDButtonText'
            MDButton:
                style: "elevated" 
                theme_width: "Custom"
                height: "56dp"
                size_hint_x: .5
                MDButtonText:
                    text: "Meus Sentimentos"

            MDButton:
                style: "elevated" 
                theme_width: "Custom"
                height: "56dp"
                size_hint_x: .5
                MDButtonText:
                    text: "Minhas Atividades"
            
            MDButton:
                style: "elevated" 
                theme_width: "Custom"
                height: "56dp"
                size_hint_x: .5 
                on_release: app.root.current = "diario"
                MDButtonText:
                    text: "Meu Diário"

        # --- (NOVO) Card de Vínculo ---
        MDCard:
            id: vincula_card
            orientation: "vertical"
            size_hint: .8, None
            adaptive_height: True
            pos_hint: {'center_x': .5, 'top': .40} # Posição abaixo dos botões
            padding: "15dp"
            spacing: "10dp"
            radius: [15]

            MDLabel:
                text: "Vincular a um Psicólogo"
                halign: "center"
                font_style: "Title"
                role: "medium"
            
            MDTextField:
                id: vincula_input # <-- ID corrigido
                hint_text: "Digite o código de convite"
                mode: "filled"
                radius: [15, 15, 15, 15]
                size_hint_y: None
                height: "48dp"
                theme_bg_color: "Custom"
                md_bg_color: rgba(230, 230, 230, 255)
                theme_text_color: "Custom"
                text_color: "black"

            MDButton:
                style: "filled"
                text: "Vincular Conta"
                pos_hint: {'center_x': .5}
                on_release: root.vincula() # <-- Chama a função Python

        # --- Navegação Inferior (Corrigida) ---
        MDNavigationBar:
            pos_hint: {"center_x": 0.5, "y": 0}
            
            MDNavigationItem:
                name: "home"
                text: "Home"
                icon: "home"
                
            MDNavigationItem:
                name: "conta"
                text: "Conta"
                icon: "account"
