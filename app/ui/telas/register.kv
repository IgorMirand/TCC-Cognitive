<RegisterScreen>:
    name: "register"
    MDFloatLayout:
        md_bg_color: (146/255, 199/255, 163/255, 1)

        # --- Área do Logo ---
        MDBoxLayout:
            orientation: 'horizontal'
            #adaptive_size: True
            adaptive_height: True
            pos_hint: {'center_x': .7, 'top': .92}
            spacing: "5dp"

            Image:
                source: "app/assets/img.png"
                size_hint: None, None
                size: "64dp", "64dp"

            MDLabel:
                text: "Cognitive"
                font_style: "Display"
                role: "small"
                valign: "center"
                theme_text_color: "Custom"
                text_color: (0.2, 0.2, 0.2, 1)

        # --- Área do Formulário ---
        MDBoxLayout:
            orientation: 'vertical'
            size_hint: .8, None
            height: self.minimum_height
            pos_hint: {'center_x': .5, 'center_y': .5} # Posição ajustada
            spacing: "10dp"

            MDLabel:
                text: "Cadastro :"
                font_style: "Display"
                role: "small"
                halign: 'left'
                size_hint_y: None
                height: self.texture_size[1] # <-- CORREÇÃO IMPORTANTE
                theme_text_color: "Custom"
                text_color: (0.2, 0.2, 0.2, 1)

            # --- Campo Username (Corrigido de "Email") ---
            MDLabel:
                text: "Nome:" # Rótulo corrigido
                halign: 'left'
                size_hint_y: None
                height: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: (0.2, 0.2, 0.2, 1)
                padding_y: "10dp"

            MDTextField:
                id: username
                mode: "filled"
                hint_text: "Seu Username"
                radius: [15, 15, 15, 15]
                fill_color_normal: (230/255, 230/255, 230/255, 1)
                fill_color_focus: (220/255, 220/255, 220/255, 1)
                line_color_normal: (0,0,0,0)
                line_color_focus: (0,0,0,0)
                text_color_normal: (0, 0, 0, 1)
                text_color_focus: (0, 0, 0, 1)
                size_hint_y: None
                height: "48dp"

            # --- (NOVO) Campo Email ---
            MDLabel:
                text: "Email:"
                halign: 'left'
                size_hint_y: None
                height: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: rgba(51, 51, 51, 255)
                padding_y: "10dp"
            
            MDTextField:
                id: email_input # <-- NOVO ID
                mode: "filled"
                hint_text: "seu.email@exemplo.com"
                radius: [15]
                size_hint_y: None
                height: "48dp"
                

            # --- (NOVO) Campo Idade ---
            MDLabel:
                text: "Data de Nacimento:"
                halign: 'left'
                size_hint_y: None
                height: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: rgba(51, 51, 51, 255)
                padding_y: "10dp"
                
            MDButton:
                pos_hint: {'center_x': .5, 'center_y': .5}
                # CORREÇÃO 1: Mudei de 'app' para 'root'
                on_release: root.show_modal_date_picker()

                MDButtonText:
                    # CORREÇÃO 2: Adicionei o ID para o Python ler depois
                    id: data_nacimento 
                    text: "Selecionar Data"

            # --- Campo Senha ---
            MDLabel:
                text: "Senha:"
                halign: 'left'
                size_hint_y: None
                height: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: (0.2, 0.2, 0.2, 1)
                padding_y: "10dp"

            MDTextField:
                id: password
                mode: "filled"
                hint_text: "Sua senha"
                password: True
                radius: [15, 15, 15, 15]
                fill_color_normal: (230/255, 230/255, 230/255, 1)
                fill_color_focus: (220/255, 220/255, 220/255, 1)
                line_color_normal: (0,0,0,0)
                line_color_focus: (0,0,0,0)
                text_color_normal: (0, 0, 0, 1)
                text_color_focus: (0, 0, 0, 1)
                size_hint_y: None
                height: "48dp"
            
            MDLabel:
                text: "Tipo de Usuário"
                halign: 'left'
                size_hint_y: None
                height: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: (0.2, 0.2, 0.2, 1)
                padding_y: "10dp"

            MDDropDownItem:
                id: tipo_usuario
                pos_hint: {"center_x": 0.1}
                on_release: root.menu_tipo.open()
                MDDropDownItemText:
                    text: "Selecione"


            MDTextField:
                id: codigo_acesso
                hint_text: "Seu código (se for Psicólogo)"
                mode: "filled"
                radius: [15, 15, 15, 15]
                height: "48dp"
                opacity: 0
                disabled: True
                MDTextFieldHintText:
                    text: "Código de Acesso"
                    mode: "persistent"



        # --- Botões ---
        MDButton:      
            style: "elevated" 
            theme_width: "Custom"
            pos_hint: {'center_x': .5, 'y': .08}
            height: "56dp"
            size_hint_x: .5  
            on_release: root.do_register()
            
            MDButtonText:
                text: "Cadastrar"
                pos_hint: {"center_x": .5, "center_y": .5}

        MDButton:      
            style: "elevated" 
            theme_width: "Custom"
            pos_hint: {'center_x': .5, 'y': .01}
            height: "56dp"
            size_hint_x: .5  
            on_release: app.root.current = "main"
            MDButtonText:
                text: "Voltar"
                pos_hint: {"center_x": .5, "center_y": .5}
